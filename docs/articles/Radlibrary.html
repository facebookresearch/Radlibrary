<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started with `Radlibrary` • Radlibrary</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with `Radlibrary`">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Radlibrary</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/Radlibrary.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Getting started with <code>Radlibrary</code>
</h1>
            
      
      
      <div class="hidden name"><code>Radlibrary.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This vignette serves two distinct, but related, purposes:</p>
<ul>
<li><p>To document the steps required to get started with the Facebook Ad Library API.</p></li>
<li><p>To through getting started with the <code>Radlibrary</code> package to query, analyze, and visualize data from the Facebook Ad Library API</p></li>
</ul>
</div>
<div id="getting-set-up" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-set-up" class="anchor"></a>Getting Set Up</h2>
<p>There are three basic steps required to begin used the Facebook Ad Library API.</p>
<ol style="list-style-type: decimal">
<li>Confirm your identity and location</li>
<li>Create a Facebook Developer account</li>
<li>Add a new app</li>
</ol>
<div id="confirm-your-identity-and-location-with-facebook" class="section level3">
<h3 class="hasAnchor">
<a href="#confirm-your-identity-and-location-with-facebook" class="anchor"></a>Confirm your identity and location with Facebook</h3>
<p>Currently, accessing the Facebook Ads API utilizes the same verification process that is required to run ads about social issues, elections or politics. To complete this process, go to <a href="https://www.facebook.com/ID">the ID section of your Facebook settings</a>. To complete this process, you will need to submit a form of national identification to confirm your identity. If you haven’t already confirmed your ID, it typically takes 1-2 days to complete this step.</p>
<p><strong>Note</strong>: Your identification will need to match your physical location for verification purposes.</p>
</div>
<div id="create-a-facebook-developer-account" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-facebook-developer-account" class="anchor"></a>Create a Facebook Developer account</h3>
<p>Visit <a href="https://developers.facebook.com/">Facebook for Developers</a> and select Get Started to sign up for a developer account. As part of account creation, you’ll need to agree to our Platform Policy.</p>
</div>
<div id="add-a-new-app" class="section level3">
<h3 class="hasAnchor">
<a href="#add-a-new-app" class="anchor"></a>Add a new App</h3>
<p>Once you have an account, you’ll need to create a new app. Go to the <a href="https://developers.facebook.com/tools/explorer/">Explorer tool</a> and click “Create App” under “My Apps”.</p>
<p><strong>IMPORTANT NOTE ABOUT ACCESS TOKENS</strong> Anyone who obtains your access token can use it to access your Facebook account until the token expires. Treat your access token as you would a password. Avoid putting it in source code, in your command history, and especially on GitHub or somewhere else online.</p>
</div>
</div>
<div id="getting-started-with-radlibrary" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-started-with-radlibrary" class="anchor"></a>Getting Started with <code>Radlibrary</code>
</h2>
<p>To get started using the <code>Radlibrary</code> package, you’ll want to take the following steps:</p>
<ol style="list-style-type: decimal">
<li>Retrieve and store your access token</li>
<li>Build a query</li>
<li>Submit the query</li>
<li>Analyze the results</li>
</ol>
<div id="retrieve-and-store-your-access-token-" class="section level3">
<h3 class="hasAnchor">
<a href="#retrieve-and-store-your-access-token-" class="anchor"></a>Retrieve and store your access token.</h3>
<p>You can find your access token on <a href="https://developers.facebook.com/tools/explorer/%22">Facebook for Developers</a></p>
<p>Note that this token can only be used for a limited period of time and will have to be periodically refreshed. If you’d like to use <code>Radlibrary</code> functionality to generate a persistent token, see <a href="#generating-persistent-tokens">Generating persistent tokens</a>. If you do not need a long-term token, you can save your token to your environment. <strong>Note:</strong> the best way to store your access token interactively is to use <code>readline</code> and paste the token at the prompt.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">## This will store your access token in your R history—not recommended!</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">token &lt;-<span class="st"> "PASTED VALUE FROM https://developers.facebook.com/tools/explorer/"</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">## better:</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">token &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readline.html">readline</a></span>()</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co"># now paste at the prompt</span></a></code></pre></div>
<p>This way, your access token won’t be stored in your R history.</p>
</div>
<div id="build-a-query" class="section level3">
<h3 class="hasAnchor">
<a href="#build-a-query" class="anchor"></a>Build a query</h3>
<p>Let’s build our first query!</p>
<p>We’ll start with a simple example. Let’s look for all active ads within the United States that served impressions in the past 90 days and are related to health care.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">query &lt;-<span class="st"> </span><span class="kw"><a href="../reference/adlib_build_query.html">adlib_build_query</a></span>(<span class="dt">ad_reached_countries =</span> <span class="st">'US'</span>, </a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="dt">ad_active_status =</span> <span class="st">'ACTIVE'</span>, </a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="dt">impression_condition =</span> <span class="st">'HAS_IMPRESSIONS_LAST_90_DAYS'</span>, </a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="dt">search_terms =</span> <span class="st">"healthcare"</span>,</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="dt">fields =</span> <span class="st">"ad_data"</span>)</a></code></pre></div>
<p>There are numerous parameters to the <code>adlib_build_query</code> function (for more, see <code><a href="../reference/adlib_build_query.html">?adlib_build_query</a></code>). In the above, we’re passing five parameters:</p>
<ul>
<li>
<code>ad_reached_countries = 'US'</code>: this tells they query we only want to return ads shown in the United States. Note that the query submission will fail if you try and submit an ISO country code that you are not verified for.</li>
<li>
<code>ad_active_status = 'ACTIVE'</code>: this tells they query we only want to return ads that are currently active.</li>
<li>
<code>impression_condition = 'HAS_IMPRESSIONS_LAST_90_DAYS'</code>: this tells they query we want to see any ad that has served impressions in the last 90 days.</li>
<li>
<code>search_terms = "healthcare"</code>: this is the search string for the query. <strong>Note</strong>: You can only search for single keywords. For example, you can search “health care,” but the system will search for these words separately (i.e. “health” and “care”).</li>
<li>
<code>fields = "ad_data"</code>: this is the fields to include in the response. In this example, we’re looking strictly at ad data. We could also search for aggregated data related to regional delivery or demographics.</li>
</ul>
</div>
<div id="submit-a-query" class="section level3">
<h3 class="hasAnchor">
<a href="#submit-a-query" class="anchor"></a>Submit a query</h3>
<p>Let’s submit the query from the previous section for analysis.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">response &lt;-<span class="st"> </span><span class="kw"><a href="../reference/adlib_get.html">adlib_get</a></span>(<span class="dt">query =</span> query, <span class="dt">token =</span> token)</a></code></pre></div>
<p>The <code><a href="../reference/adlib_get.html">adlib_get()</a></code> requires a query and a token. It will return an object type of <code>adlib_data_response</code> which contains ad data for up to 1,000 rows matching the query parameters. This objective has numerous metadata attributes:</p>
<ul>
<li>
<code>date</code>: the time stamp of the query submission</li>
<li>
<code>has_next</code>: A Boolean value indicating whether there are still pages available after the current search returned (see section on pagination below)</li>
<li>
<code>next_page</code>: The URL to call the next page of responses</li>
<li>
<code>fields</code>: the fields available in the query</li>
<li>
<code>data</code>: the data returned.</li>
</ul>
</div>
<div id="analyze-the-results" class="section level3">
<h3 class="hasAnchor">
<a href="#analyze-the-results" class="anchor"></a>Analyze the results</h3>
<p>You can convert your results into a <code>tibble</code> using <code>as_tibble</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">results.tibble &lt;-<span class="st"> </span><span class="kw"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(results, <span class="dt">type =</span> <span class="st">"ad"</span>)</a></code></pre></div>
<p>This will transform the information stored in <code>data</code> and in <code>fields</code> from your <code>adlib_data_response</code> into a tidy data frame (i.e., a tibble) for analysis. The example content below from the above:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(results.tibble)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#  A tibble: 6 x 15</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#  ad_creation_time    ad_creative_body ad_creative_lin… ad_creative_lin… </span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#  &lt;dttm&gt;              &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;           </span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co"># 1 2019-12-09 02:24:23 I believe in He… NA               NA              </span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co"># 2 2019-12-09 00:24:56 Will you stand … act.actwireless… Legislators sho… </span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co"># 3 2019-12-08 22:23:09 "https://youtu.… youtube.com      My name is Stev… </span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co"># 4 2019-12-08 22:22:36 Will you stand … act.actwireless… Legislators sho… </span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co"># 5 2019-12-08 21:53:34 "Sen. Warren fl… ma.publiceditor… Sen. Warren is … </span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co"># 6 2019-12-08 21:45:55 "Marvin Lim for… www.marvinlimfo… NA               </span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co"># … with 11 more variables: ad_delivery_stop_time &lt;dttm&gt;, currency &lt;chr&gt; ... </span></a></code></pre></div>
<p>As an example - we can display this data visually. Let’s use <code>ggplot2</code> and visualize the top 20 page names by number of ads created.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">results.tibble <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(page_name) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(page_name) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="st">  </span><span class="kw">top_n</span>(<span class="dt">n =</span> <span class="dv">20</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="kw"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span>(<span class="dt">x =</span> page_name, n), <span class="dt">y =</span> n)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">"identity"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Page Name"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">"Count of Ads"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="st">  </span><span class="kw">coord_flip</span>()</a></code></pre></div>
<p><img src="example.png" style="display: block; margin: auto auto auto 0;"></p>
</div>
</div>
<div id="generating-persistent-tokens" class="section level2">
<h2 class="hasAnchor">
<a href="#generating-persistent-tokens" class="anchor"></a>Generating Persistent Tokens</h2>
<p>You may want to generate a persistent token that allows you to avoid having to refresh your token every hour. You can use the <code>App ID</code> and <code>App Secret</code> to generate a persistent token that works for 60 days. It is important to store this secret securely. To facilitate this, we’ve included functionality from <a href="https://cran.r-project.org/web/packages/keyring/index.html"><code>keyring</code> library</a>.</p>
<p>To begin, run this command:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/adlib_setup.html">adlib_setup</a></span>()</a></code></pre></div>
<p>This will generate the following prompt:</p>
<pre><code>Visit https://developers.facebook.com/ and navigate to your App's basic settings
to find your Application ID and App Secret.
These will be securely stored in your computer's credential store.
Press &lt;Enter&gt;</code></pre>
<p>If you’ve already stored an Application ID at some point, you’ll also receive a prompt as to whether or not you’d like to overwrite your previously stored information.</p>
<p>You’ll then be asked via prompt to access and input your Application ID and your App Secret. You can then run the <code><a href="../reference/adlib_set_longterm_token.html">adlib_set_longterm_token()</a></code> command, follow the prompts, and store your persistent access token within your system’s credential store.</p>
<p>If you have a long-term token stored, <code>Radlibrary</code> will find it automatically when you run <code>adlib_get</code></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">response &lt;-<span class="st"> </span><span class="kw"><a href="../reference/adlib_get.html">adlib_get</a></span>(<span class="dt">query =</span> query)</a></code></pre></div>
<p>You can also retrieve your stored token at any time with <code><a href="../reference/token_get.html">token_get()</a></code>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#getting-set-up">Getting Set Up</a></li>
      <li><a href="#getting-started-with-radlibrary">Getting Started with <code>Radlibrary</code></a></li>
      <li><a href="#generating-persistent-tokens">Generating Persistent Tokens</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Colin Fraser, Kyle Shank.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
